<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore the #OpenSourceHumanities movement, featuring tweets and community venues. Join the conversation and see where the community is making an impact.">
    <title>#OpenSourceHumanities</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Open Source Humanities Hub</h1>

    <!-- Main Page Image -->
    <div class="main-image">
        <img src="Images/Gbux-IGaUAA7b13.jpeg" alt="Open Source Humanities Image">
    </div>

    <!-- Navigation for Tabs -->
    <div class="tabs" role="tablist">
        <button class="tab-button" role="tab" aria-selected="false" aria-controls="tweets-tab" id="tab-tweets" onclick="showTab('tweets-tab')">Tweets</button>
        <button class="tab-button" role="tab" aria-selected="false" aria-controls="venues-tab" id="tab-venues" onclick="showTab('venues-tab')">Community Venues</button>
        <button class="tab-button" role="tab" aria-selected="false" aria-controls="people-tab" id="tab-people" onclick="showTab('people-tab')">People Involved</button>
        <button class="tab-button" role="tab" aria-selected="false" aria-controls="services-tab" id="tab-services" onclick="showTab('services-tab')">Paid-for Academic Services</button>
        <button class="tab-button" role="tab" aria-selected="false" aria-controls="blog-tab" id="tab-blog" onclick="showTab('blog-tab')">The Differential Ontology Blog</button>
        <button class="tab-button" role="tab" aria-selected="false" aria-controls="resources-tab" id="tab-resources" onclick="showTab('resources-tab')">Community Involvement Resources</button>
    </div>

    <!-- Community Involvement Resources Tab Content -->
    <div id="resources-tab" class="tab-content" role="tabpanel" aria-labelledby="tab-resources" style="display: none;">
        <h2>Community Involvement Resources</h2>
        <div id="resources-container">
            <ul>
                <li>
                    <a href="https://github.com/nimshav/Open-Source-Humanities" target="_blank" rel="noopener noreferrer">
                        View #OpenSourceHumanities on GitHub
                    </a>
                </li>
                <li>
                    <a href="https://www.youtube.com/watch?v=mJ-qvsxPHpY" target="_blank" rel="noopener noreferrer">
                        Git Tutorial for Dummies
                    </a>
                    <p>
                        This tutorial is recommended as a way to get to know Git and GitHub. Real dummies -- like me&nbsp;--
                        can use the
                        <a href="https://desktop.github.com/download/" target="_blank" rel="noopener noreferrer">
                            GitHub application for desktop
                        </a>.
                    </p>
                </li>
            </ul>
        </div>
    </div>

    <noscript>
        <p>JavaScript is required to load the content of this page. Please enable JavaScript in your browser settings.</p>
    </noscript>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tweetsTabButton = document.querySelector('.tab-button[onclick="showTab(\'tweets-tab\')"]');
            const tweetsContainer = document.getElementById('tweets-container');
            let tweetsFetched = false;

            async function fetchAndDisplayTweets() {
                if (tweetsFetched) return;

                tweetsContainer.innerHTML = '<p>Loading tweets...</p>';

                try {
                    const response = await fetch('/api/tweets');

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'Failed to fetch tweets');
                    }

                    const data = await response.json();
                    tweetsContainer.innerHTML = '';

                    if (data.data && data.data.length > 0) {
                        data.data.forEach(tweet => {
                            const tweetElement = document.createElement('div');
                            tweetElement.className = 'tweet';

                            tweetElement.innerHTML = `
                                <p>${formatText(tweet.text)}</p>
                                <span class="tweet-date">Posted on: ${new Date(tweet.created_at).toLocaleString()}</span>
                            `;

                            tweetsContainer.appendChild(tweetElement);
                        });
                    } else {
                        tweetsContainer.innerHTML = '<p>No tweets found for the hashtag.</p>';
                    }

                    tweetsFetched = true;
                } catch (error) {
                    console.error('Error fetching tweets:', error);
                    tweetsContainer.innerHTML = '<p>Error loading tweets. Please try again later.</p>';
                }
            }

            function formatText(text) {
                return text
                    .replace(/#(\w+)/g, '<a href="https://twitter.com/hashtag/$1" target="_blank" rel="noopener noreferrer">#$1</a>')
                    .replace(/@(\w+)/g, '<a href="https://twitter.com/$1" target="_blank" rel="noopener noreferrer">@$1</a>');
            }

            tweetsTabButton.addEventListener('click', fetchAndDisplayTweets);
            showTab('tweets-tab');
        });

        function showTab(tabId) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.style.display = 'none');

            const activeTab = document.getElementById(tabId);
            activeTab.style.display = 'block';

            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
                button.setAttribute('aria-selected', 'false');
            });
            const activeButton = document.querySelector(`.tab-button[onclick="showTab('${tabId}')"]`);
            if (activeButton) {
                activeButton.classList.add('active');
                activeButton.setAttribute('aria-selected', 'true');
            }
        }
    </script>
</body>
</html>